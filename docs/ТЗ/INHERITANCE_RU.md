# ТЗ: "МОИ СУДЫ" и "ПОДАТЬ В СУД"

(только меню, формы и отправка данных)

---

## МОИ СУДЫ — меню

⚖️ МОИ СУДЫ
━━━━━━━━━━━━━━
📝 Подать в суд
📖 Открытые дела
⏳ В процессе
✅ Завершённые дела
⬅️ Назад

---

## ПОДАТЬ В СУД — логика

### Шаг 1. Выбор типа спора

Показать кнопки:

- 💰 Финансовый спор
- 🤝 Нарушение договора
- 🏠 Имущество/аренда
- 📦 Поставка / товар
- 🛠 Услуги / работа
- 💍 Семейный вопрос
- ✋ Этический конфликт
- ⬅️ Назад

Сохраняем в БД: `category`

---

### Шаг 2. Стороны

Тексты:

- Укажите истца (например: Мухаммад).
- Укажите ответчика (имя или ник в Telegram).

Поля:

- `plaintiff_name`
- `defendant_name`

Проверка на персональные данные (паспорт, адрес, слишком личные данные):

- ❌ Личные данные запрещены.
  Укажите только имя или ник.

---

### Шаг 3. Описание ситуации

Текст:

Опишите ситуацию простыми словами:
- что произошло
- когда
- что вы хотите (выплата, возврат, признание долга, извинение)

Сохраняем: `claim_text`

---

### Шаг 4. Дополнительные данные (по необходимости)

- Если категория "Финансовый спор":
  - Укажите сумму спора (в валюте). Если нет суммы — напишите "нет".
  - Сохраняем: `amount` (число или null)

- Если категория "Поставка / товар" или "Услуги / работа":
  - Есть договор?
  - Кнопки: 📄 Да (загрузить) / ❌ Нет

- Если категория "Семейный вопрос":
  - Это связано с наследством или никахом?
  - Если да — перенаправить в нужный раздел.
  - Если нет — продолжаем.

---

### Шаг 5. Доказательства

Текст:

Вы можете прикрепить доказательства (по желанию):
- 📎 Фото документов
- 🔗 Ссылка на облачное хранилище
- 🎧 Аудио
- 📄 Текст
- ⏭️ Пропустить

Все вложения сохраняем в массив `evidence[]`.

Блокируется:
- фото людей без нужды
- интимные материалы
- оскорбления
- запрещённые файлы

Сообщение при нарушении:

- ❌ Этот файл нельзя использовать как доказательство.
  Попробуйте другой.

---

### Шаг 6. Подтверждение

Бот выводит собранные данные:

📌 ЗАЯВКА В СУД

Истец: {plaintiff}
Ответчик: {defendant}
Категория: {category}
Суть: {claim_text}
Сумма (если есть): {amount}
Доказательства: {кол-во файлов}

Отправить дело учёному?

Кнопки:

- ✔️ Отправить
- ✏️ Изменить
- ❌ Отмена

---

### Шаг 7. Создание дела

При подтверждении:

📁 Дело №2025-000123 создано.
Статус: ОТКРЫТО
Учёный будет назначен.

Запись в БД:

Поле | Значение
--- | ---
`case_id` | авто
`user_id` | ID Telegram
`category` | перечисление
`plaintiff` | текст
`defendant` | текст
`claim` | текст
`amount` | число/null
`evidence` | массив
`status` | "open"
`scholar_id` | null
`created_at` | временная метка

---

## 📖 Открытые дела

Вывод списка:

📌 №2025-000123 — Финансы
Стороны: Вы vs {Имя}
Статус: Открыто
➡️ Подробнее

Экран "Подробнее":

📄 Описание
⚖️ Суть: {claim}
📎 Доказательства: {кол-во}

Кнопки:

- 📥 Добавить доказательство
- ✏️ Редактировать описание
- 🗂 Изменить категорию
- ❌ Отменить дело
- ➡️ Передать учёному
- ⬅️ Назад

---

## ⏳ В процессе

Сюда попадают дела после назначения учёного.

📌 №2025-000123
Статус: В процессе
Судья: {имя/ник}
Связь: {ссылка на чат или канал}

Кнопки:

- 🎥 Видеосвязь (создать ссылку)
- 📥 Добавить доказательство
- 📨 Напомнить учёному
- ⬅️ Назад

---

## ✅ Завершённые дела

📌 №2025-000123
Статус: Завершено
📜 Решение (хукм): получено

Кнопки:

- 📄 Скачать решение
- 🔗 Поделиться ссылкой
- 🛡 Жалоба на исполнение
- 🔁 Открыть новое дело по этой теме
- ⬅️ Назад

---

## 🕌 Шариат-фильтр (без GPT)

Перед отправкой учёному бот проверяет:

Нарушение | Реакция
--- | ---
Требование процентов (риба) | ❌ Блокировать
Неясные условия (гарар) | ⚠️ Просить уточнить
Угрозы/оскорбления | ❌ Запретить подачу
Спор по никаху/наследству | ↪️ Перенаправить в соответствующий раздел
Отсутствие сути | ⚠️ Попросить кратко написать, иначе не создаём дело

Сообщение при блокировке:

- ❌ Требование противоречит шариату и не может быть подано.
Пожалуйста, исправьте запрос.

---

## Подключение ответчика к делу (модель двух участников)

### Общая логика

1. Истец создаёт дело.
2. Бот генерирует уникальный код и ссылку приглашения.
3. Истец передаёт ссылку ответчику.
4. Ответчик переходит по ссылке - бот привязывает его к делу.
5. Оба видят одно дело, но права разные.

---

### Поля в базе

- `case_id`
- `plaintiff_id` (TG ID истца)
- `defendant_id` (TG ID ответчика, null до подключения)
- `participants` (массив: `plaintiff_id`, `defendant_id`)
- `invite_code` (строка 6-8 символов)

---

### Создание кода

При создании дела генерировать `invite_code`, например `ABX4F9` или `DK-92-FA`.

Ответ истцу:

Ответчик ещё не подключён. Передайте ссылку:
https://t.me/ИмяБота?start=ABX4F9

---

### Подключение ответчика

Ответчик переходит по ссылке с параметром `start`.

Проверки:

- если `invite_code` существует и `defendant_id == null`, то:
  - `defendant_id = user_id`
  - добавить `user_id` в `participants`
  - статус: "ответчик подключён"
- иначе отказ (код недействителен или уже использован)

Сообщение ответчику:

Вы подключены к делу №2025-000123.
Теперь доступны:
- добавить доказательства
- написать комментарий
- посмотреть описание
- оспорить требования

Уведомление истцу:

Ответчик подключился к делу.

---

### Разграничение прав

Действие | Истец | Ответчик
--- | --- | ---
Изменить описание | да | нет
Добавить доказательства | да | да
Смотреть файлы другой стороны | да | да
Запросить медиацию | да | да
Передать учёному | да | нет
Отозвать дело | да | нет
Оспорить сумму | да | да

---

### Доказательства

Оба участника используют единый интерфейс.

Сохраняем в БД:

`evidence`: массив объектов
- `uploaded_by`: `user_id`
- `timestamp`
- `file_type`
- `file_id` или `file_url`

Подпись на стороне бота:

Файл добавлен: photo_001.png  
Добавил: Истец

---

### Внутренний чат (опционально)

Можно добавить раздел "Сообщения".
Все участники из `participants` видят чат.
Учёный может быть подключён как третий наблюдатель.

---

### FSM по ролям

Истец: `create` -> `invite` -> `manage` -> `submit_to_scholar`  
Ответчик: `join_with_code` -> `view` -> `evidence` / `comment` / `dispute`

---

### Проверки доступа

Все операции проверяют:

- если `user_id` в `participants` — разрешено
- иначе отказ: "Вы не участник дела"

---

### Кнопка для мирного решения

Добавить кнопку:




`Попытаться решить мирно`


Xnj-nj ckjvfk
